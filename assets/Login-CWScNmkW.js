import{r as s,M as x,N,j as e,g as L,O as S,Q as p,T as I,L as E}from"./index-HNNhyVJ8.js";const T=()=>{const{setInputVal:u}=s.useContext(x),[i,g]=s.useState(""),[r,m]=s.useState(""),[o,t]=s.useState(),[h,j]=s.useState(""),b=N(),{issLoading:f,setIsLoading:c,Alert:l}=s.useContext(x),v=localStorage.getItem("relogin")||null,y=localStorage.getItem("InactiveLogout")||null;s.useEffect(()=>{y==="true"?(t(l(!1,"You have been logged out due to inactivity. Please login again")),setTimeout(()=>{t(null),localStorage.removeItem("InactiveLogout")},6e3)):v==="true"?(t(l(!1,"Your session has expired. Please login again")),setTimeout(()=>{t(null),localStorage.removeItem("relogin")},6e3)):console.log("no action")},[]);const w=async d=>{d.preventDefault(),c(!0),j("Logging in...");try{const n=await fetch("http://localhost:5000/login",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({email:i,password:r})}),a=await n.json();n.ok||(c(!1),t(l(!1,a.message)),console.log(a)),c(!1),t(l(!0,a.message)),console.log(a),localStorage.setItem("UserInfo",JSON.stringify(a)),a.success===!0&&(localStorage.setItem("IsLogin",!0),setTimeout(()=>{b("/stream/")},100)),g(""),m("")}catch(n){console.log(n.message),t(l(!1,n.message))}finally{setTimeout(()=>{t(null)},2e3)}};return s.useEffect(()=>{console.log("email",i)},[i]),s.useEffect(()=>{console.log("pass",r)},[r]),s.useEffect(()=>{console.log("result:",o)},[o]),e.jsx(L,{children:e.jsxs("div",{className:"mx-auto relative px-6  md:my-20 flexCol ",children:[e.jsx("div",{className:` ${o?"Animate":"hidden"} fixed Alert  left-0 w-full z-40 flex justify-center items-center `,children:e.jsx("div",{className:" bg-text text-dry w-1/2 rounded-md border-[3px] border-subMain flex justify-center items-center p-4",children:o&&e.jsx("p",{children:o})})}),e.jsx("div",{className:`${f?"":"hidden"} absolute top-0 left-0 w-full h-full flex justify-center  bg-modal z-40`,children:f&&e.jsxs("div",{className:" fixed top-[200px] h-24 w-1/2 rounded-md border-border text-white  flex flex-col justify-center items-center ",children:[e.jsx(S,{className:"h-10 w-10 animate-spin"}),e.jsx("p",{className:"font-semibold",children:h})]})}),e.jsxs("div",{className:"p-6 md:p-4 md:w-[70%]  lg:w-[40%] bg-dry  rounded-lg flexCol justify-center items-center border-2 border-border  ",children:[e.jsx("div",{className:"rounded-full   login_logo",children:e.jsx("img",{src:"https://res.cloudinary.com/dtjgj2odu/image/upload/v1734517937/StreamLogo_ao5f75.png",alt:"logo",className:" w-28 h-28 object-contain"})}),e.jsxs("form",{className:"flex flexCol gap-5 w-full",children:[e.jsx(p,{label:"Email",placeholder:"Streamview@gmail.com",type:"email",setter:g,setInputVal:u,mainVal:i,bg:!0,indicator:"Email"}),e.jsx(p,{label:"Password",placeholder:"********",type:"password",setter:m,setInputVal:u,mainVal:r,bg:!0,indicator:"password"}),e.jsxs("button",{onClick:d=>w(d),className:"bg-subMain transi hover:bg-main flexRow gap-4 text-white p-4 rounded-lg w-full ",children:[e.jsx(I,{})," Login"]}),e.jsxs("p",{className:"text-center text-border",children:["Don't have an account?",e.jsxs(E,{to:"/stream/register",className:"text-dryGray transi hover:text-subMain font-semibold",children:[" ","Signup"]})]})]})]})]})})};export{T as default};
