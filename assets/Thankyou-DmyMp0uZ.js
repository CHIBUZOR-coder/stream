import{r as a,M as w,P as E,u as I,j as e,f as N}from"./index-B1U6WZZ4.js";const M=()=>{const{Result:S,setResult:l,Alert:c,User:d,Autentification:m}=a.useContext(w),[u]=E(),[r,T]=a.useState(u.get("transaction_id")),[f,x]=a.useState(!0),[t,h]=a.useState(""),p=localStorage.getItem("orderId"),g=d?d.userInfo.email:"unavailable email",[v,y]=a.useState([]),b=I();a.useEffect(()=>{console.log("status:",t)},[t]);const j=async(s,i)=>{try{const n=await fetch("http://localhost:5000/verify",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({transaction_id:s,orderId:i,email:g})}),o=await n.json();n.ok?(console.log(o),l(c(!0,o.message)||"Order successful"),localStorage.setItem("Recipt",o.data),x(!1),localStorage.removeItem("orderId"),h(o.data.status),m(),setTimeout(()=>{b("/stream/")},4e3)):l(c(!1,o.message)||"Order failed")}catch(n){console.log(n)}finally{setTimeout(()=>{l(null)},3e3)}};return a.useEffect(()=>{r&&j(r,p)},[r]),a.useEffect(()=>{if(t==="COMPLETED"){let s=0;const i=setInterval(()=>{y(n=>[...n,{id:s++,left:Math.random()*100+"vw",animationDuration:Math.random()*2+3+"s"}])},300);return setTimeout(()=>clearInterval(i),4e3),()=>clearInterval(i)}},[t]),e.jsx(N,{children:e.jsxs("div",{className:"flex flex-col items-center justify-center min-h-screen bg-main px-10 gap-10 relative overflow-hidden",children:[f?e.jsx("div",{className:"bg-white flex justify-center items-center ringg shadow-lg max-w-md text-center rounded-full p-2 h-48 w-48 relative",children:e.jsx("div",{className:"text-subMain font-semibold animate-pulse",children:"Verifying Payment..."})}):t&&t==="COMPLETED"?e.jsx("div",{children:e.jsxs("h2",{className:"text-2xl font-bold text-white text-center",children:["Payment Successful! ",e.jsx("br",{}),"Thank you for subscribing to our service!"]})}):e.jsx("h2",{className:"text-2xl font-bold text-red-500",children:"Payment Failed!"}),t==="COMPLETED"?e.jsxs("div",{className:" bg-dry rounded p-8  border-2  border-border flexCol gap-5",children:[e.jsx("p",{className:"font-semibold text-2xl text-white",children:"You will be redirected to the home page."}),e.jsx("p",{className:"font-semibold text-2xl text-white",children:"Happy viewing"}),e.jsx("p",{className:"font-semibold text-4xl text-white animate-bounce",children:"ðŸ¤—"})]}):"",t==="COMPLETED"&&v.map(s=>e.jsx("span",{className:"absolute text-4xl animate-fall",style:{left:s.left,animationDuration:s.animationDuration},children:"ðŸŽ‰"},s.id)),e.jsx("style",{children:`
            @keyframes fall {
              0% { transform: translateY(-100vh); opacity: 1; }
              100% { transform: translateY(100vh); opacity: 0; }
            }
            .animate-fall {
              position: absolute;
              top: 0;
              animation: fall linear infinite;
            }
          `})]})})};export{M as default};
